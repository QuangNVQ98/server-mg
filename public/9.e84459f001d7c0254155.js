(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{"4+IK":function(t,i,e){"use strict";e.r(i),e.d(i,"AccountModule",function(){return j});var c=e("ofXK"),o=e("3Pt+"),n=e("QJFE"),r=e("1kSV"),b=e("E/pa"),a=e("ZOsW"),s=e("tyNb"),l=e("fXoL");let d=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=l.Hb({type:t,selectors:[["app-account"]],decls:1,vars:0,template:function(t,i){1&t&&l.Ob(0,"router-outlet")},directives:[s.f],encapsulation:2}),t})();var u=e("XNiG"),f=e("1G5W"),h=e("R7bP"),m=e("Wr45"),p=e("twk+"),S=e("5eHb"),v=e("ogFu"),T=e("B4aS"),g=e("UWxd");function y(t,i){if(1&t&&(l.Rb(0),l.Tb(1,"div",5),l.Tb(2,"div",6),l.Tb(3,"div",7),l.Tb(4,"label"),l.Dc(5,"M\u1eadt kh\u1ea9u "),l.Tb(6,"span",8),l.Dc(7,"*"),l.Sb(),l.Sb(),l.Sb(),l.Tb(8,"div",9),l.Ob(9,"ft-input",10),l.Sb(),l.Sb(),l.Sb(),l.Tb(10,"div",5),l.Tb(11,"div",6),l.Tb(12,"div",7),l.Tb(13,"label"),l.Dc(14,"Nh\u1eadp l\u1ea1i m\u1eadt kh\u1ea9u "),l.Tb(15,"span",8),l.Dc(16,"*"),l.Sb(),l.Sb(),l.Sb(),l.Tb(17,"div",9),l.Ob(18,"ft-input",10),l.Sb(),l.Sb(),l.Sb(),l.Qb()),2&t){const t=l.fc();l.Ab(9),l.lc("type","password")("formGroup",t.form)("controlName","password"),l.Ab(9),l.lc("type","password")("formGroup",t.form)("controlName","confirm_password")}}function D(t,i){if(1&t&&(l.Tb(0,"option",13),l.Dc(1),l.Sb()),2&t){const t=i.$implicit;l.lc("value",t.code),l.Ab(1),l.Ec(t.label)}}function k(t,i){1&t&&(l.Tb(0,"span",8),l.Dc(1," Th\xf4ng tin kh\xf4ng \u0111\u01b0\u1ee3c \u0111\u1ec3 tr\u1ed1ng "),l.Sb())}function A(t,i){if(1&t&&(l.Tb(0,"div"),l.Bc(1,k,2,0,"span",20),l.Sb()),2&t){const t=l.fc(2);l.Ab(1),l.lc("ngIf",t.checkValid("acl","required"))}}function _(t,i){if(1&t&&(l.Rb(0),l.Tb(1,"div",6),l.Tb(2,"div",7),l.Tb(3,"label"),l.Dc(4,"Quy\u1ec1n"),l.Sb(),l.Sb(),l.Tb(5,"div",9),l.Ob(6,"ng-select",19),l.Bc(7,A,2,1,"div",11),l.Sb(),l.Sb(),l.Qb()),2&t){const t=l.fc();l.Ab(6),l.lc("items",t.lstPermission)("multiple",!0)("closeOnSelect",!1),l.Ab(1),l.lc("ngIf",t.checkControlValid("acl"))}}function w(t,i){1&t&&l.Ob(0,"cpd-loading-overlay")}let O=(()=>{class t{constructor(t,i,e,c){this.activeModal=t,this.fb=i,this.toastrService=e,this.apiAccountService=c,this._unsubscribe$=new u.a,this.lstPermission=p.a,this.lstRole=p.b}ngOnInit(){this.buildForm(),this.id&&this.buildFormEdit()}buildForm(){this.form=this.fb.group({full_name:["",o.o.required],phone:[""],email:["",[o.o.required,o.o.email]],password:["",o.o.required],confirm_password:["",o.o.required],role:["",o.o.required],acl:[""]},{validator:Object(m.a)("password","confirm_password")})}changeRole(){2==this.form.get("role").value?(this.form.get("acl").setValidators([o.o.required]),this.form.get("acl").updateValueAndValidity({onlySelf:!0})):(this.form.get("acl").clearValidators(),this.form.get("acl").updateValueAndValidity({onlySelf:!0}))}buildFormEdit(){this.form=this.fb.group({full_name:["",o.o.required],phone:[""],email:["",[o.o.required,o.o.email]],role:["",o.o.required],acl:[""]}),this.isLoading=!0,this.apiAccountService.getById(this.id).pipe(Object(f.a)(this._unsubscribe$)).subscribe(t=>{this.isLoading=!1,t&&t.status&&(this.form.patchValue(t.data),this.changeRole())},t=>{this.isLoading=!1})}checkValid(t,i){return this.form.get(t).hasError(i)&&(this.form.get(t).touched||this.form.get(t).dirty)}checkControlValid(t){return this.form.get(t).invalid&&(this.form.get(t).touched||this.form.get(t).dirty)}validateForm(){Object.keys(this.form.controls).forEach(t=>{this.form.get(t).markAsTouched({onlySelf:!0})})}onSubmit(){if(this.validateForm(),this.form.valid){const t=this.form.value;this.id&&(t.id=this.id),this.isLoading=!0,this.apiAccountService.save(t).pipe(Object(f.a)(this._unsubscribe$)).subscribe(t=>{this.isLoading=!1,t&&204===t.error_code&&this.form.get("email").setErrors({notUnique:!0}),t&&t.status&&(Object(h.g)(this.toastrService,null,"L\u01b0u th\xe0nh c\xf4ng"),this.activeModal.close("ok"))},t=>{this.isLoading=!1})}}onClose(){this.activeModal.close()}ngOnDestroy(){this._unsubscribe$.next(),this._unsubscribe$.complete()}}return t.\u0275fac=function(i){return new(i||t)(l.Nb(r.a),l.Nb(o.b),l.Nb(S.b),l.Nb(v.a))},t.\u0275cmp=l.Hb({type:t,selectors:[["app-account-form"]],decls:54,vars:16,consts:[[1,"modal-header"],[1,"modal-title","modal__title_20"],["type","button","data-dismiss","modal","aria-hidden","true",1,"close",3,"click"],[1,"modal-body"],[3,"formGroup"],[1,"form-group"],[1,"row"],[1,"col-md-3"],[1,"text-danger"],[1,"col-md-9"],[3,"type","formGroup","controlName"],[4,"ngIf"],["formControlName","role",1,"form-control",3,"change"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"modal-footer"],[1,"col-md-9","offset-md-3","d-flex"],["type","button",1,"btn","btn-secondary","mr-2",3,"click"],["type","button",1,"btn","btn-primary",3,"click"],["bindLabel","label","bindValue","code","placeholder","Ch\u1ecdn quy\u1ec1n","formControlName","acl",3,"items","multiple","closeOnSelect"],["class","text-danger",4,"ngIf"]],template:function(t,i){1&t&&(l.Tb(0,"div"),l.Tb(1,"div",0),l.Tb(2,"h4",1),l.Dc(3),l.Sb(),l.Tb(4,"button",2),l.dc("click",function(){return i.onClose()}),l.Dc(5,"\xd7"),l.Sb(),l.Sb(),l.Tb(6,"div",3),l.Tb(7,"form",4),l.Tb(8,"div",5),l.Tb(9,"div",6),l.Tb(10,"div",7),l.Tb(11,"label"),l.Dc(12,"T\xean "),l.Tb(13,"span",8),l.Dc(14,"*"),l.Sb(),l.Sb(),l.Sb(),l.Tb(15,"div",9),l.Ob(16,"ft-input",10),l.Sb(),l.Sb(),l.Sb(),l.Tb(17,"div",5),l.Tb(18,"div",6),l.Tb(19,"div",7),l.Tb(20,"label"),l.Dc(21,"S\u1ed1 \u0111i\u1ec7n tho\u1ea1i"),l.Sb(),l.Sb(),l.Tb(22,"div",9),l.Ob(23,"ft-input",10),l.Sb(),l.Sb(),l.Sb(),l.Tb(24,"div",5),l.Tb(25,"div",6),l.Tb(26,"div",7),l.Tb(27,"label"),l.Dc(28,"Email "),l.Tb(29,"span",8),l.Dc(30,"*"),l.Sb(),l.Sb(),l.Sb(),l.Tb(31,"div",9),l.Ob(32,"ft-input",10),l.Sb(),l.Sb(),l.Sb(),l.Bc(33,y,19,6,"ng-container",11),l.Tb(34,"div",5),l.Tb(35,"div",6),l.Tb(36,"div",7),l.Tb(37,"label"),l.Dc(38,"Nh\xf3m quy\u1ec1n "),l.Tb(39,"span",8),l.Dc(40,"*"),l.Sb(),l.Sb(),l.Sb(),l.Tb(41,"div",9),l.Tb(42,"select",12),l.dc("change",function(){return i.changeRole()}),l.Tb(43,"option",13),l.Dc(44,"-- Ch\u1ecdn nh\xf3m quy\u1ec1n --"),l.Sb(),l.Bc(45,D,2,2,"option",14),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Bc(46,_,8,4,"ng-container",11),l.Sb(),l.Sb(),l.Tb(47,"div",15),l.Tb(48,"div",16),l.Tb(49,"button",17),l.dc("click",function(){return i.onClose()}),l.Dc(50,"H\u1ee7y"),l.Sb(),l.Tb(51,"button",18),l.dc("click",function(){return i.onSubmit()}),l.Dc(52,"L\u01b0u"),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Bc(53,w,1,0,"cpd-loading-overlay",11)),2&t&&(l.Ab(3),l.Ec(i.id?"S\u1eeda t\xe0i kho\u1ea3n":"Th\xeam m\u1edbi t\xe0i kho\u1ea3n"),l.Ab(4),l.lc("formGroup",i.form),l.Ab(9),l.lc("type","text")("formGroup",i.form)("controlName","full_name"),l.Ab(7),l.lc("type","text")("formGroup",i.form)("controlName","phone"),l.Ab(9),l.lc("type","text")("formGroup",i.form)("controlName","email"),l.Ab(1),l.lc("ngIf",!i.id),l.Ab(10),l.lc("value",""),l.Ab(2),l.lc("ngForOf",i.lstRole),l.Ab(1),l.lc("ngIf",2==i.form.get("role").value),l.Ab(7),l.lc("ngIf",i.isLoading))},directives:[o.p,o.j,o.d,T.a,c.k,o.n,o.i,o.c,o.k,o.q,c.j,a.a,g.a],styles:[""]}),t})();var F=e("sFQb");const x=["modalConfirm"];function C(t,i){if(1&t){const t=l.Ub();l.Rb(0),l.Tb(1,"i",15),l.dc("click",function(){l.vc(t);const i=l.fc().$implicit;return l.fc().openForm(i._id)}),l.Sb(),l.Qb()}}function B(t,i){if(1&t){const t=l.Ub();l.Tb(0,"i",17),l.dc("click",function(){l.vc(t);const i=l.fc(2).$implicit;return l.fc().onDelete(i._id)}),l.Sb()}}function N(t,i){if(1&t&&(l.Rb(0),l.Bc(1,B,1,0,"i",16),l.Qb()),2&t){const t=l.fc().$implicit;l.Ab(1),l.lc("ngIf",1!=t.is_super)}}function I(t,i){if(1&t&&(l.Tb(0,"tr"),l.Tb(1,"td"),l.Ob(2,"img",14),l.Sb(),l.Tb(3,"td"),l.Dc(4),l.Sb(),l.Tb(5,"td"),l.Dc(6),l.Sb(),l.Tb(7,"td"),l.Dc(8),l.Sb(),l.Tb(9,"td"),l.Bc(10,C,2,0,"ng-container",13),l.Bc(11,N,2,1,"ng-container",13),l.Sb(),l.Sb()),2&t){const t=i.$implicit,e=l.fc();l.Ab(4),l.Fc(" ",t.full_name," "),l.Ab(2),l.Fc(" ",t.email," "),l.Ab(2),l.Fc(" ",t.phone?t.phone:"--"," "),l.Ab(2),l.lc("ngIf",e.canEdit(t._id,t.role)),l.Ab(1),l.lc("ngIf",e.canDelete())}}function L(t,i){1&t&&l.Ob(0,"cpd-loading-overlay")}const q=[{path:"",component:d,children:[{path:"",component:(()=>{class t{constructor(t,i,e){this.modalService=t,this.apiAccountService=i,this._accountService=e,this._unsubscribe$=new u.a}ngOnInit(){this.search()}search(){this.isLoading=!0,this.apiAccountService.getList().pipe(Object(f.a)(this._unsubscribe$)).subscribe(t=>{this.data=t.data,this.isLoading=!1},t=>{this.isLoading=!1})}openForm(t){const i=this.modalService.open(O,{size:"lg",backdrop:"static"});t&&(i.componentInstance.id=t),i.result.then(t=>{t&&this.search()})}onDelete(t){this.idTemp=t,this.modalConfirm.fire()}confirm(){console.log(this.idTemp)}canDelete(){return this._accountService.account&&1==this._accountService.account.is_super}canEdit(t,i){return i!=p.f||this._accountService.account&&(1==this._accountService.account.is_super||this._accountService.account._id==t)}ngOnDestroy(){this._unsubscribe$.next(),this._unsubscribe$.complete()}}return t.\u0275fac=function(i){return new(i||t)(l.Nb(r.e),l.Nb(v.a),l.Nb(F.a))},t.\u0275cmp=l.Hb({type:t,selectors:[["app-account-list"]],viewQuery:function(t,i){if(1&t&&l.Hc(x,1),2&t){let t;l.tc(t=l.ec())&&(i.modalConfirm=t.first)}},decls:30,vars:6,consts:[[1,"container-fluid"],[1,"d-flex","mb-3","justify-content-between"],[1,"h3","text-gray-800"],[1,"btn","btn-success",3,"click"],[1,"card","shadow","mb-4"],[1,"card-header","py-3"],[1,"m-0","font-weight-bold","text-primary"],[1,"card-body"],[1,"table-responsive"],[1,"table","table-hover","mb-0"],[4,"ngFor","ngForOf"],["title","X\xe1c nh\u1eadn x\xf3a account","type","question",3,"confirmButtonText","cancelButtonText","showCancelButton","allowOutsideClick","confirm"],["modalConfirm",""],[4,"ngIf"],["src","/assets/images/img-avatar.jpg","alt","avatar",1,"rounded-circle","avatar"],[1,"fas","fa-edit","mr-2","cursor-pointer",3,"click"],["class","fas fa-trash-alt text-danger cursor-pointer",3,"click",4,"ngIf"],[1,"fas","fa-trash-alt","text-danger","cursor-pointer",3,"click"]],template:function(t,i){1&t&&(l.Tb(0,"div",0),l.Tb(1,"div",1),l.Tb(2,"h1",2),l.Dc(3,"Qu\u1ea3n l\xfd t\xe0i kho\u1ea3n"),l.Sb(),l.Tb(4,"button",3),l.dc("click",function(){return i.openForm()}),l.Dc(5,"Th\xeam m\u1edbi"),l.Sb(),l.Sb(),l.Tb(6,"div",4),l.Tb(7,"div",5),l.Tb(8,"h6",6),l.Dc(9,"Danh s\xe1ch"),l.Sb(),l.Sb(),l.Tb(10,"div",7),l.Tb(11,"div",8),l.Tb(12,"table",9),l.Tb(13,"thead"),l.Tb(14,"tr"),l.Tb(15,"th"),l.Dc(16,"Avatar"),l.Sb(),l.Tb(17,"th"),l.Dc(18,"T\xean"),l.Sb(),l.Tb(19,"th"),l.Dc(20,"Email"),l.Sb(),l.Tb(21,"th"),l.Dc(22,"S\u1ed1 \u0111i\u1ec7n tho\u1ea1i"),l.Sb(),l.Tb(23,"th"),l.Dc(24,"H\xe0nh \u0111\u1ed9ng"),l.Sb(),l.Sb(),l.Sb(),l.Tb(25,"tbody"),l.Bc(26,I,12,5,"tr",10),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Tb(27,"swal",11,12),l.dc("confirm",function(){return i.confirm()}),l.Sb(),l.Bc(29,L,1,0,"cpd-loading-overlay",13)),2&t&&(l.Ab(26),l.lc("ngForOf",i.data),l.Ab(1),l.lc("confirmButtonText","C\xf3")("cancelButtonText","Kh\xf4ng")("showCancelButton",!0)("allowOutsideClick",!1),l.Ab(2),l.lc("ngIf",i.isLoading))},directives:[c.j,n.a,c.k,g.a],styles:[".avatar[_ngcontent-%COMP%]{width:80px;height:auto}"]}),t})()}]}];let $=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=l.Lb({type:t}),t.\u0275inj=l.Kb({imports:[[c.b,s.e.forChild(q)],s.e]}),t})(),j=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=l.Lb({type:t}),t.\u0275inj=l.Kb({imports:[[c.b,$,o.e,n.b,o.m,r.c,b.a,a.b,r.p]]}),t})()}}]);